#include <memory>
#include <string>
#include <vector>
#include <iostream>
#include <fstream>
#include <math.h>
#include <map>
#include <sstream>
#include <iomanip>

#include "TFile.h"
#include "TH1.h"
#include "TCanvas.h"
#include "TMath.h"
#include "RiceStyle.h"
#include "TGaxis.h"

using namespace std;

//MSTW2008lo90cl 21050
//Q2=2
double xG_Q2_2_mstw[]={42.63,30.446,25.5299,22.696,20.8174,19.474,18.3923,17.526,16.8145,16.229,15.7268,15.2782,14.8745,14.509,14.1762,13.8718,13.5922,13.3345,13.0961,12.875,12.6699,12.4792,12.3013,12.1345,11.9777,11.8297,11.6895,11.5564,11.4296,11.3086,11.1928,11.0816,10.9748,10.8719,10.7726,10.6767,10.5837,10.4936,10.4061,10.321,10.2388,10.1599,10.0841,10.0111,9.94067,9.87263,9.8068,9.743,9.68109,9.62091,9.56236,9.5053,9.44963,9.39525,9.34208,9.29002,9.239,9.18895,9.13981,9.0915,9.04419,8.99804,8.95297,8.90895,8.8659,8.82378,8.78255,8.74216,8.70257,8.66373,8.62562,8.5882,8.55144,8.5153,8.47976,8.44479,8.41036,8.37645,8.34304,8.3101,8.27763,8.24563,8.2141,8.18304,8.15245,8.12233,8.09268,8.06349,8.03476,8.00649,7.97868,7.95132,7.92442,7.89796,7.87194,7.84637,7.82123,7.79652,7.77225,7.7484,7.7249,7.70166,7.67868,7.65596,7.63349,7.61127,7.58928,7.56753,7.54602,7.52473,7.50367,7.48282,7.4622,7.44178,7.42158,7.40158,7.38178,7.36218,7.34277,7.32356,7.30453,7.28569,7.26704,7.24856,7.23026,7.21213,7.19418,7.17639,7.15877,7.14131,7.12401,7.10687,7.08989,7.07306,7.05638,7.03985,7.02347,7.00723,6.99113,6.97518,6.95936,6.94368,6.92814,6.91272,6.89744,6.88229,6.86726,6.85236,6.83758,6.82293,6.8084,6.79398,6.77968,6.7655,6.75143,6.73748,6.72363,6.7099,6.69627,6.68275,6.66934,6.65603,6.64283,6.62972,6.61672,6.60381,6.59101,6.5783,6.56568,6.55316,6.54074,6.5284,6.51616,6.50401,6.49194,6.47997,6.46808,6.45627,6.44456,6.43292,6.42137,6.4099,6.39851,6.38721,6.37598,6.36483,6.35375,6.34276,6.33184,6.32099,6.31022,6.29953,6.2889,6.27835,6.26787,6.25746,6.24711,6.23684,6.22664,6.2165,6.11877,6.02714,5.94092,5.85952,5.78244,5.70926,5.63959,5.57312,5.50956,5.44865,5.39018,5.33395,5.27978,5.22753,5.17704,5.12819,5.08087,5.03498,4.99041,4.9471,4.90517,4.86474,4.8257,4.78795,4.7514,4.71596,4.68156,4.64814,4.61563,4.58396,4.55309,4.52296,4.49354,4.46477,4.43663,4.40906,4.38205,4.35555,4.32955,4.304,4.27897,4.2545,4.23057,4.20715,4.18422,4.16175,4.13973,4.11813,4.09693,4.07613,4.05569,4.03561,4.01587,3.99645,3.97735,3.95855,3.94003,3.92179,3.90382,3.8861,3.86865,3.85147,3.83456,3.81791,3.80151,3.78536,3.76945,3.75378,3.73834,3.72312,3.70812,3.69333,3.67875,3.66437,3.65019,3.6362,3.6224,3.60879,3.59536,3.5821,3.56901,3.55607,3.54328,3.53063,3.51814,3.50578,3.49356,3.48147,3.46952,3.4577,3.44601,3.43445,3.42301,3.41169,3.40049,3.38941,3.37845,3.3676,3.35686,3.34623,3.33571,3.3253,3.31499,3.30479,3.29468,3.28468,3.27477,3.26497,3.25525,3.24563,3.23611,3.22667,3.21732,3.20807,3.1989,3.18981,3.18081,3.17189,3.16306,3.1543,3.14562,3.13702,3.1285,3.12004,3.11166,3.10336,3.09512,3.08695,3.07885,3.07081,3.06285,3.05495,3.04711,3.03933,3.03162,3.02397,3.01638,3.00885,3.00138,2.99397,2.98662,2.97932,2.97207,2.96489,2.95775,2.95067,2.94365,2.93667,2.92975,2.92287,2.91605,2.90928,2.90255,2.89588,2.88925,2.88267,2.87613,2.86964,2.8632,2.8568,2.85044,2.84413,2.83786,2.83164,2.82545,2.81931,2.81321,2.80715,2.80112,2.79514,2.7892,2.78329,2.77743,2.7716,2.76581,2.76006,2.75434,2.74866,2.74301,2.7374,2.73182,2.72628,2.72078,2.71531,2.70987,2.70446,2.69909,2.69375,2.68844,2.68317,2.67792,2.67271,2.66753,2.66238,2.65725,2.65216,2.6471,2.64206,2.63706,2.63208,2.62713,2.62221,2.61731,2.61245,2.60761,2.60279,2.598,2.59324,2.5885,2.58379,2.57911,2.57445,2.56981,2.5652,2.56061,2.55604,2.5515,2.54698,2.54249,2.53802,2.53357,2.52914,2.52474,2.52035,2.51599,2.51165,2.50733,2.50304,2.49876,2.4945,2.49027,2.48605,2.48186,2.47768,2.47353,2.46939,2.46527,2.46118,2.4571,2.45304,2.44899,2.44497,2.44097,2.43698,2.43301,2.42906,2.42512,2.42121,2.41731,2.41343,2.40956,2.40571,2.40188,2.39807,2.39427,2.39048,2.38672,2.38297,2.37923,2.37551,2.37181,2.36812,2.36444,2.36079,2.35714,2.35351,2.3499,2.3463,2.34271,2.33914,2.33559,2.33205,2.32852,2.325,2.3215,2.31801,2.31454,2.31108,2.30763,2.3042,2.30078,2.29738,2.29399,2.29061,2.28725,2.2839,2.28057,2.27725,2.27395,2.27066,2.26738,2.26412,2.26087,2.25763,2.25441,2.2512,2.24801,2.24482,2.24165,2.2385,2.23535,2.23222,2.2291,2.22599,2.2229,2.21981,2.21674,2.21369,2.21064,2.20761,2.20458,2.20157,2.19857,2.19558,2.19261,2.18964,2.18669,2.18374,2.18081,2.17789,2.17498,2.17208,2.16919,2.16631,2.16345,2.16059,2.15774,2.15491,2.15208,2.14927,2.14646,2.14366,2.14088,2.1381,2.13534,2.13258,2.12983,2.1271,2.12437,2.12165,2.11894,2.11624,2.11355,2.11087,2.1082,2.10554,2.10289,2.10024,2.09761,2.09498,2.09236,2.08975,2.08715,2.08456,2.08198,2.0794,2.07683,2.07428,2.07173,2.06918,2.06665,2.06413,2.06161,2.0591,2.0566,2.0541,2.05162,2.04914,2.04667,2.04421,2.04175,2.03931,2.03687,2.03444,2.03201,2.02959,2.02719,2.02478,2.02239,2.02,2.01762,2.01525,2.01288,2.01052,2.00817,2.00582,2.00348,2.00115,1.99883,1.99651,1.9942,1.9919,1.9896,1.98731,1.98502,1.98274,1.98047,1.97821,1.97595,1.9737};
double xG_err_Q2_2_mstw[]={28.4731,13.4123,8.70119,6.46208,5.17993,4.39427,3.78385,3.33913,3.01126,2.76805,2.57052,2.40024,2.25212,2.12227,2.0077,1.90605,1.81542,1.73429,1.66139,1.59567,1.53685,1.48444,1.4374,1.39491,1.35627,1.32091,1.28837,1.25825,1.23021,1.20398,1.17931,1.15601,1.13389,1.1128,1.09261,1.07322,1.05451,1.03641,1.01883,1.00172,0.985409,0.970179,0.955915,0.942513,0.92988,0.917933,0.906599,0.89581,0.885508,0.875639,0.866155,0.857012,0.84817,0.839595,0.831254,0.823117,0.815159,0.807355,0.799683,0.792124,0.78476,0.777671,0.770838,0.764243,0.757867,0.751696,0.745716,0.739911,0.73427,0.728781,0.723434,0.718217,0.713121,0.708138,0.70326,0.698478,0.693785,0.689175,0.684641,0.680178,0.675793,0.671497,0.667289,0.663168,0.659134,0.655186,0.651323,0.647543,0.643846,0.640231,0.636697,0.633242,0.629866,0.626568,0.623347,0.620201,0.61713,0.614132,0.611207,0.608352,0.605554,0.602797,0.60008,0.597402,0.594763,0.59216,0.589594,0.587063,0.584568,0.582106,0.579678,0.577282,0.574918,0.572585,0.570283,0.568011,0.565768,0.563554,0.561368,0.55921,0.557078,0.554973,0.552894,0.55084,0.548811,0.546806,0.544825,0.542868,0.540934,0.539023,0.537133,0.535265,0.533419,0.531594,0.529789,0.528004,0.526239,0.524494,0.522768,0.52106,0.519371,0.5177,0.516047,0.514411,0.512793,0.511191,0.509606,0.508038,0.506485,0.504948,0.503427,0.501921,0.50043,0.498954,0.497492,0.496045,0.494611,0.493192,0.491786,0.490393,0.489014,0.487647,0.486294,0.484953,0.483624,0.482307,0.481003,0.47971,0.478429,0.47716,0.475901,0.474654,0.473418,0.472193,0.470978,0.469773,0.468579,0.467396,0.466222,0.465058,0.463904,0.462759,0.461624,0.460499,0.459382,0.458275,0.457176,0.456087,0.455006,0.453933,0.45287,0.451814,0.450767,0.449728,0.448696,0.447673,0.446658,0.44565,0.44465,0.443657,0.434182,0.425454,0.417371,0.409847,0.402812,0.396205,0.389976,0.384083,0.378488,0.373161,0.368073,0.363201,0.358525,0.354026,0.349689,0.345498,0.341443,0.337512,0.333694,0.329982,0.326394,0.322943,0.319621,0.316415,0.313317,0.31032,0.307415,0.304596,0.301857,0.299193,0.296598,0.294068,0.291599,0.289188,0.28683,0.284522,0.282262,0.280047,0.277874,0.275742,0.273653,0.271612,0.269615,0.267662,0.26575,0.263877,0.262041,0.260241,0.258475,0.256741,0.255039,0.253366,0.251722,0.250106,0.248516,0.246951,0.245411,0.243894,0.2424,0.240928,0.239477,0.238049,0.236643,0.235258,0.233894,0.23255,0.231226,0.229922,0.228637,0.22737,0.226121,0.224891,0.223677,0.222481,0.221302,0.220139,0.218992,0.21786,0.216744,0.215644,0.214557,0.213484,0.212425,0.211379,0.210346,0.209325,0.208317,0.207321,0.206337,0.205365,0.204404,0.203454,0.202516,0.201588,0.200672,0.199765,0.198869,0.197983,0.197107,0.196241,0.195384,0.194537,0.193699,0.192871,0.192051,0.19124,0.190437,0.189644,0.188858,0.188081,0.187312,0.186551,0.185798,0.185052,0.184315,0.183584,0.182861,0.182145,0.181437,0.180735,0.18004,0.179352,0.178671,0.177996,0.177328,0.176666,0.176011,0.175361,0.174718,0.174081,0.17345,0.172825,0.172206,0.171592,0.170984,0.170382,0.169785,0.169194,0.168609,0.168028,0.167453,0.166883,0.166319,0.165759,0.165205,0.164655,0.164111,0.163571,0.163036,0.162506,0.161981,0.16146,0.160944,0.160432,0.159925,0.159422,0.158924,0.15843,0.15794,0.157454,0.156973,0.156496,0.156023,0.155553,0.155088,0.154627,0.15417,0.153716,0.153267,0.152821,0.152379,0.15194,0.151505,0.151074,0.150646,0.150222,0.149802,0.149384,0.148971,0.14856,0.148153,0.147749,0.147349,0.146952,0.146558,0.146167,0.14578,0.145395,0.145014,0.144636,0.14426,0.143888,0.143519,0.143153,0.14279,0.142429,0.142072,0.141717,0.141365,0.141016,0.14067,0.140326,0.139985,0.139647,0.139312,0.138979,0.138648,0.13832,0.137995,0.137673,0.137352,0.137035,0.136719,0.136406,0.136096,0.135788,0.135482,0.135179,0.134878,0.134579,0.134282,0.133988,0.133696,0.133406,0.133119,0.132833,0.13255,0.132269,0.13199,0.131713,0.131438,0.131165,0.130894,0.130625,0.130358,0.130093,0.12983,0.129569,0.12931,0.129053,0.128798,0.128544,0.128293,0.128043,0.127795,0.127549,0.127305,0.127062,0.126821,0.126582,0.126345,0.126109,0.125875,0.125643,0.125413,0.125184,0.124956,0.12473,0.124506,0.124284,0.124063,0.123843,0.123626,0.123409,0.123194,0.122981,0.122769,0.122559,0.12235,0.122143,0.121937,0.121732,0.121529,0.121327,0.121127,0.120928,0.12073,0.120534,0.120339,0.120146,0.119953,0.119763,0.119573,0.119385,0.119199,0.119014,0.11883,0.118647,0.118466,0.118286,0.118108,0.117931,0.117755,0.11758,0.117407,0.117235,0.117064,0.116894,0.116726,0.116559,0.116393,0.116228,0.116064,0.115902,0.115741,0.115581,0.115422,0.115264,0.115107,0.114952,0.114797,0.114644,0.114491,0.11434,0.11419,0.114041,0.113892,0.113745,0.113599,0.113454,0.11331,0.113167,0.113025,0.112884,0.112743,0.112604,0.112466,0.112328,0.112192,0.112056,0.111922,0.111788,0.111655,0.111523,0.111392,0.111261,0.111132,0.111003,0.110875,0.110748,0.110622,0.110496,0.110372,0.110248,0.110125,0.110003,0.109881,0.10976,0.10964,0.109521,0.109402,0.109284,0.109167,0.10905,0.108935,0.108819,0.108705,0.108591,0.108478,0.108365,0.108253,0.108142,0.108032,0.107922,0.107812,0.107703,0.107595,0.107488,0.107381,0.107274,0.107168,0.107063,0.106958,0.106854,0.10675,0.106647,0.106544,0.106442,0.106341,0.10624,0.106139,0.106039,0.10594,0.105841,0.105743,0.105646,0.105549,0.105453,0.105358,0.105263,0.105169,0.105075,0.104982,0.10489,0.104798,0.104707,0.104616,0.104526,0.104437,0.104348};

//Q2=10
double xG_Q2_10_mstw[] = {169.91,126.95,107.268,95.071,86.6238,80.338,75.2743,71.148,67.6835,64.793,62.3098,60.0842,58.0765,56.2553,54.5953,53.0759,51.68,50.3934,49.2041,48.102,47.0792,46.1275,45.2382,44.4043,43.6195,42.8785,42.1768,41.5106,40.8763,40.2711,39.6922,39.1373,38.6045,38.0919,37.5978,37.1208,36.6597,36.2132,35.7803,35.36,34.9548,34.5666,34.1941,33.8359,33.4911,33.1584,32.837,32.5261,32.2247,31.9322,31.648,31.3715,31.102,30.8391,30.5823,30.3312,30.0853,29.8444,29.6081,29.376,29.1491,28.9281,28.7128,28.5028,28.2978,28.0977,27.9021,27.7107,27.5234,27.34,27.1603,26.984,26.811,26.6412,26.4743,26.3103,26.149,25.9903,25.834,25.68,25.5283,25.3789,25.2318,25.0871,24.9447,24.8046,24.6669,24.5316,24.3986,24.268,24.1397,24.0138,23.8902,23.769,23.65,23.5334,23.4192,23.3072,23.1974,23.09,22.9843,22.8799,22.7767,22.6747,22.5739,22.4742,22.3757,22.2783,22.182,22.0868,21.9926,21.8995,21.8074,21.7163,21.6262,21.5371,21.4489,21.3617,21.2754,21.19,21.1055,21.0218,20.9391,20.8572,20.7761,20.6958,20.6164,20.5377,20.4599,20.3828,20.3065,20.2309,20.1561,20.082,20.0086,19.9359,19.8639,19.7926,19.722,19.652,19.5827,19.5141,19.4461,19.3787,19.3119,19.2458,19.1802,19.1153,19.0509,18.9871,18.9239,18.8613,18.7992,18.7376,18.6766,18.6162,18.5562,18.4968,18.4379,18.3795,18.3216,18.2642,18.2073,18.1509,18.0949,18.0395,17.9844,17.9299,17.8758,17.8221,17.7689,17.7161,17.6638,17.6119,17.5604,17.5093,17.4586,17.4084,17.3585,17.3091,17.26,17.2113,17.163,17.1151,17.0676,17.0204,16.9736,16.9272,16.8811,16.8354,16.7901,16.745,16.7004,16.656,16.612,16.5684,16.5251,16.482,16.4394,16.397,15.9907,15.6134,15.2614,14.9318,14.6221,14.3302,14.0541,13.7922,13.5433,13.3059,13.0791,12.862,12.6536,12.4533,12.2604,12.0743,11.8944,11.7204,11.5517,11.388,11.2303,11.0796,10.9352,10.7966,10.6633,10.535,10.4111,10.2915,10.1756,10.0633,9.9543,9.8483,9.74509,9.64447,9.54624,9.45023,9.35627,9.26422,9.17394,9.0853,8.99867,8.91442,8.83241,8.75252,8.67463,8.59864,8.52443,8.45192,8.38101,8.31161,8.24366,8.17708,8.11179,8.04772,7.98483,7.92304,7.8623,7.80257,7.74378,7.6859,7.629,7.57317,7.51838,7.46459,7.41178,7.35992,7.30899,7.25895,7.20979,7.16148,7.11399,7.06731,7.02141,6.97627,6.93187,6.8882,6.84524,6.80296,6.76135,6.7204,6.68004,6.64022,6.60092,6.56214,6.52387,6.48609,6.4488,6.41199,6.37565,6.33976,6.30433,6.26934,6.23479,6.20067,6.16696,6.13367,6.10078,6.0683,6.0362,6.00449,5.97315,5.94219,5.9116,5.88136,5.85148,5.82194,5.79275,5.76389,5.73536,5.70716,5.67928,5.65172,5.62447,5.59752,5.57087,5.54452,5.51847,5.4927,5.46721,5.442,5.41706,5.39238,5.36796,5.3438,5.31988,5.2962,5.27276,5.24956,5.22659,5.20385,5.18134,5.15904,5.13696,5.1151,5.09345,5.072,5.05076,5.02971,5.00887,4.98822,4.96776,4.94749,4.92741,4.9075,4.88778,4.86824,4.84887,4.82968,4.81065,4.79179,4.7731,4.75456,4.73619,4.71798,4.69992,4.68202,4.66427,4.64666,4.62921,4.6119,4.59473,4.57771,4.56082,4.54407,4.52746,4.51098,4.49463,4.47842,4.46233,4.44637,4.43053,4.41482,4.39923,4.38376,4.36841,4.35318,4.33807,4.32306,4.30818,4.2934,4.27874,4.26419,4.24975,4.23542,4.2212,4.20709,4.19308,4.17917,4.16537,4.15168,4.13808,4.12458,4.11117,4.09787,4.08465,4.07154,4.05851,4.04558,4.03273,4.01998,4.00731,3.99473,3.98223,3.96982,3.95749,3.94524,3.93308,3.92099,3.90899,3.89706,3.88521,3.87343,3.86174,3.85011,3.83856,3.82708,3.81568,3.80434,3.79308,3.78188,3.77075,3.75969,3.7487,3.73777,3.72691,3.71611,3.70538,3.69471,3.6841,3.67355,3.66307,3.65264,3.64228,3.63197,3.62172,3.61153,3.60139,3.59131,3.58129,3.57132,3.56141,3.55155,3.54174,3.53199,3.52229,3.51264,3.50304,3.49349,3.48399,3.47454,3.46514,3.45578,3.44648,3.43722,3.42801,3.41884,3.40972,3.40065,3.39162,3.38264,3.37369,3.3648,3.35594,3.34713,3.33836,3.32963,3.32095,3.3123,3.3037,3.29513,3.28661,3.27812,3.26967,3.26126,3.25289,3.24456,3.23627,3.22801,3.21979,3.2116,3.20346,3.19536,3.1873,3.1793,3.17133,3.16341,3.15554,3.14771,3.13992,3.13217,3.12447,3.1168,3.10918,3.1016,3.09406,3.08656,3.0791,3.07168,3.0643,3.05695,3.04965,3.04238,3.03515,3.02796,3.0208,3.01368,3.0066,2.99956,2.99255,2.98557,2.97863,2.97172,2.96485,2.95802,2.95121,2.94444,2.93771,2.931,2.92433,2.91769,2.91108,2.90451,2.89797,2.89145,2.88497,2.87852,2.8721,2.86571,2.85935,2.85302,2.84672,2.84045,2.8342,2.82799,2.8218,2.81564,2.80951,2.80341,2.79734,2.79129,2.78527,2.77928,2.77331,2.76737,2.76145,2.75557,2.7497,2.74387,2.73805,2.73227,2.7265,2.72077,2.71505,2.70937,2.7037,2.69806,2.69244,2.68685,2.68128,2.67573,2.67021,2.66471,2.65923,2.65378,2.64834,2.64293,2.63754,2.63217,2.62683,2.6215,2.6162,2.61092,2.60566,2.60042,2.5952,2.59,2.58482,2.57966,2.57452,2.5694,2.5643,2.55922,2.55416,2.54912,2.54409,2.53909,2.5341,2.52913,2.52418,2.51925,2.51434,2.50944,2.50456,2.4997,2.49486,2.49004,2.48523,2.48044,2.47567,2.47091};
double xG_err_Q2_10_mstw[] = {25.647,12.946,8.95132,7.0067,5.85541,5.11944,4.54211,4.10846,3.77613,3.52,3.30784,3.12235,2.95883,2.81364,2.68396,2.56752,2.46251,2.36743,2.28105,2.20233,2.13083,2.06597,2.00677,1.95243,1.90228,1.85576,1.81241,1.77183,1.73368,1.69767,1.66355,1.63111,1.60016,1.57054,1.5421,1.51473,1.48832,1.46277,1.43799,1.41391,1.39085,1.36907,1.34845,1.32887,1.31022,1.29243,1.2754,1.25907,1.24337,1.22823,1.2136,1.19943,1.18569,1.17232,1.15929,1.14656,1.13411,1.12191,1.10994,1.09816,1.08667,1.07554,1.06476,1.0543,1.04415,1.03427,1.02467,1.01531,1.00618,0.997272,0.988569,0.980058,0.971728,0.963568,0.955568,0.947717,0.940007,0.932429,0.924975,0.917638,0.910421,0.903332,0.89637,0.889537,0.882832,0.876255,0.869806,0.863485,0.857291,0.851224,0.845283,0.839467,0.833777,0.82821,0.822767,0.817447,0.812248,0.807169,0.802211,0.797371,0.792621,0.787935,0.783309,0.778744,0.774237,0.769788,0.765396,0.761059,0.756776,0.752547,0.748369,0.744244,0.740168,0.736142,0.732164,0.728234,0.72435,0.720512,0.71672,0.712971,0.709266,0.705604,0.701983,0.698404,0.694865,0.691366,0.687907,0.684485,0.681102,0.677756,0.674446,0.671173,0.667935,0.664732,0.661563,0.658428,0.655326,0.652257,0.64922,0.646214,0.64324,0.640297,0.637384,0.634501,0.631647,0.628822,0.626026,0.623258,0.620517,0.617804,0.615118,0.612458,0.609824,0.607216,0.604634,0.602076,0.599544,0.597035,0.594551,0.59209,0.589653,0.587238,0.584847,0.582478,0.580131,0.577806,0.575502,0.57322,0.570959,0.568718,0.566498,0.564299,0.562119,0.559959,0.557818,0.555696,0.553594,0.55151,0.549444,0.547397,0.545368,0.543357,0.541364,0.539387,0.537428,0.535486,0.533561,0.531652,0.52976,0.527884,0.526024,0.52418,0.522351,0.520538,0.51874,0.516957,0.515189,0.513436,0.511698,0.509974,0.493547,0.478469,0.464557,0.451661,0.439656,0.428434,0.417905,0.407991,0.398625,0.38975,0.381316,0.373279,0.365601,0.358248,0.351192,0.344406,0.337867,0.331555,0.325451,0.31954,0.313871,0.308487,0.303363,0.298475,0.293804,0.28933,0.285038,0.280911,0.276937,0.273103,0.269397,0.26581,0.262333,0.258956,0.255672,0.252474,0.249356,0.246312,0.243335,0.240422,0.237588,0.234846,0.232192,0.229619,0.227123,0.2247,0.222344,0.220053,0.217823,0.21565,0.213531,0.211464,0.209444,0.20747,0.20554,0.203651,0.2018,0.199986,0.198208,0.196463,0.194754,0.193085,0.191455,0.189861,0.188304,0.186782,0.185292,0.183836,0.18241,0.181015,0.17965,0.178313,0.177003,0.17572,0.174462,0.17323,0.172022,0.170838,0.169676,0.168536,0.167417,0.166316,0.165235,0.164171,0.163126,0.162097,0.161086,0.160092,0.159113,0.158151,0.157204,0.156273,0.155357,0.154455,0.153568,0.152694,0.151835,0.150989,0.150156,0.149337,0.14853,0.147735,0.146953,0.146183,0.145424,0.144677,0.143941,0.143216,0.142502,0.141799,0.141106,0.140423,0.139751,0.139088,0.138435,0.137791,0.137156,0.136531,0.135914,0.135306,0.134707,0.134117,0.133534,0.13296,0.132394,0.131836,0.131285,0.130742,0.130207,0.129678,0.129157,0.128642,0.128135,0.127634,0.127139,0.126651,0.12617,0.125694,0.125225,0.124761,0.124303,0.123851,0.123405,0.122964,0.122528,0.122098,0.121673,0.121253,0.120838,0.120428,0.120023,0.119622,0.119226,0.118835,0.118448,0.118066,0.117688,0.117314,0.116944,0.116578,0.116217,0.115859,0.115505,0.115156,0.114809,0.114467,0.114128,0.113793,0.113461,0.113132,0.112807,0.112485,0.112167,0.111852,0.11154,0.11123,0.110924,0.110621,0.110321,0.110024,0.10973,0.109439,0.109151,0.108866,0.108584,0.108304,0.108028,0.107754,0.107483,0.107215,0.106949,0.106686,0.106426,0.106168,0.105912,0.105659,0.105408,0.10516,0.104914,0.10467,0.104429,0.10419,0.103953,0.103718,0.103485,0.103255,0.103026,0.102799,0.102575,0.102352,0.102131,0.101913,0.101696,0.101481,0.101268,0.101056,0.100847,0.100639,0.100432,0.100228,0.100025,0.099824,0.0996245,0.0994266,0.0992303,0.0990355,0.0988422,0.0986505,0.0984603,0.0982715,0.0980842,0.0978984,0.0977139,0.0975309,0.0973492,0.0971689,0.0969899,0.0968123,0.0966359,0.0964609,0.0962871,0.0961146,0.0959433,0.0957733,0.0956044,0.0954368,0.0952703,0.095105,0.0949408,0.0947778,0.0946159,0.0944551,0.0942954,0.0941368,0.0939792,0.0938227,0.0936673,0.0935128,0.0933594,0.093207,0.0930556,0.0929051,0.0927557,0.0926072,0.0924596,0.092313,0.0921673,0.0920225,0.0918786,0.0917356,0.0915935,0.0914523,0.0913119,0.0911724,0.0910337,0.0908959,0.0907589,0.0906227,0.0904873,0.0903527,0.090219,0.090086,0.089954,0.0898227,0.0896922,0.0895625,0.0894336,0.0893055,0.0891781,0.0890515,0.0889257,0.0888005,0.0886761,0.0885524,0.0884294,0.0883071,0.0881854,0.0880645,0.0879442,0.0878246,0.0877056,0.0875872,0.0874695,0.0873524,0.087236,0.0871201,0.0870048,0.0868902,0.0867761,0.0866626,0.0865496,0.0864372,0.0863254,0.0862141,0.0861034,0.0859932,0.0858835,0.0857744,0.0856658,0.0855576,0.08545,0.0853429,0.0852362,0.0851301,0.0850244,0.0849192,0.0848145,0.0847102,0.0846064,0.084503,0.0844001,0.0842976,0.0841956,0.084094,0.0839928,0.083892,0.0837916,0.0836917,0.0835922,0.083493,0.0833943,0.0832959,0.083198,0.0831004,0.0830032,0.0829063,0.0828099,0.0827138,0.0826181,0.0825227,0.0824277,0.082333,0.0822387,0.0821447,0.0820511,0.0819578,0.0818648,0.0817721,0.0816798,0.0815878,0.0814961,0.0814048,0.0813137,0.081223,0.0811325,0.0810424,0.0809525,0.080863,0.0807737,0.0806848,0.0805961,0.0805077,0.0804196,0.0803317,0.0802442,0.0801569,0.0800699,0.0799831,0.0798966,0.0798104,0.0797245,0.0796389,0.0795536,0.0794686,0.0793839,0.0792995,0.0792155,0.0791317,0.0790483,0.0789651,0.0788823,0.0787997,0.0787174,0.0786355,0.0785538,0.0784724,0.0783912,0.0783104,0.0782298,0.0781496};

//HERAPDF15LO_EIG 60800
//Q2=10
double xG_Q2_10_60800[] = {142.068,75.5948,60.1959,52.0798,46.7604,42.9265,39.954,37.5589,35.5916,33.915,32.4609,31.1859,30.0601,29.054,28.1478,27.3228,26.5671,25.8709,25.2252,24.6254,24.0688};
double xG_err_Q2_10_60800[] = {1.52678,0.564924,0.390672,0.309154,0.260185,0.22744,0.203493,0.185265,0.171076,0.15951,0.149865,0.141732,0.134844,0.128886,0.123673,0.119092,0.115046,0.111416,0.108115,0.10512,0.102412};

double bin_change = 0.002;
double bin_width_before = 1e-5;
double bin_width_after = 1e-4;
double y_range[]={-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5};

void calculate_entropy(){

	//gStyle->SetErrorX(0);

	TFile* file = new TFile("/Users/kong/google_drive/BNL_folder/Work/EIC/Pythia/Paper/rootfiles/10M_Q2_2_movingEta_PDF21050_pythia_multiplicity_new.root");
	TFile* file1 = new TFile("/Users/kong/google_drive/BNL_folder/Work/EIC/Pythia/Paper/rootfiles/10M_Q2_10_movingEta_PDF21050_pythia_multiplicity_new.root");
	
	TF1* f1 = new TF1("f1","TMath::Exp(x[0]-6.9)",-10,10,"");
	TF1* f2 = new TF1("f2","TMath::Log(x[0])+6.9",-10,10,"");
	
	double x_range[8];
	for(int ix = 0; ix < 8; ix++){
		x_range[ix] = f1->Eval(y_range[ix]);
		//cout << "x " << x_range[ix] << endl;
	}

	double ave_x_0p5_1[7];
	double x1_range_0p5[7];
	double x2_range_0p5[7];

	for(int ieta = 0; ieta < 7; ieta++){
		ave_x_0p5_1[ieta]= f1->Integral(y_range[ieta],y_range[ieta+1])/(y_range[ieta+1]-y_range[ieta]);
		x1_range_0p5[ieta] = x_range[ieta];
		x2_range_0p5[ieta] = x_range[ieta+1];

		cout << "average x " << ave_x_0p5_1[ieta] << endl;
	}

	TH1D* Nch_gen_all_Q2_2[8];
	TH1D* Nch_gen_all_Q2_10[8];
	TH1D* all_tmp_Q2_2[8];
	TH1D* all_tmp_Q2_10[8];

	TGraphErrors* gr_hadron_Q2_2 = new TGraphErrors();
	TGraphErrors* gr_hadron_Q2_10 = new TGraphErrors();

	for(int ieta = 0; ieta < 7; ieta++){
		
		Nch_gen_all_Q2_2[ieta] = (TH1D*) file->Get( Form("Nch_gen_all_%d",ieta) );
		all_tmp_Q2_2[ieta] = (TH1D*) Nch_gen_all_Q2_2[ieta]->Clone(Form("all_tmp_Q2_2_%d",ieta));
		Nch_gen_all_Q2_2[ieta]->Scale(1.0/Nch_gen_all_Q2_2[ieta]->Integral());
		
		Nch_gen_all_Q2_10[ieta] = (TH1D*) file1->Get( Form("Nch_gen_all_%d",ieta) );
		all_tmp_Q2_10[ieta] = (TH1D*) Nch_gen_all_Q2_10[ieta]->Clone(Form("all_tmp_Q2_10_%d",ieta));
		Nch_gen_all_Q2_10[ieta]->Scale(1.0/Nch_gen_all_Q2_10[ieta]->Integral());
		
		double entropy_all = 0.0;
		double entropy_all_error = 0.0;
		
		for(int i = 0; i < Nch_gen_all_Q2_2[ieta]->GetNbinsX(); i++){

			double pn = Nch_gen_all_Q2_2[ieta]->GetBinContent(i+1);
			double pn_err = all_tmp_Q2_2[ieta]->GetBinError(i+1)/all_tmp_Q2_2[ieta]->GetBinContent(i+1);
			pn_err = pn*pn_err;
			
			if( pn == 0. ) continue;
			entropy_all += (-pn)*TMath::Log(pn);
			entropy_all_error += (pn_err*pn_err)*((1.+TMath::Log(pn))*(1.+TMath::Log(pn)) );
		}
		
		//cout << "entropy_all " << entropy_all << endl;
		gr_hadron_Q2_2->SetPoint(ieta,ave_x_0p5_1[ieta],entropy_all);
		gr_hadron_Q2_2->SetPointError(ieta,0,entropy_all_error);

		entropy_all = 0.0;
		entropy_all_error = 0.0;
		for(int i = 0; i < Nch_gen_all_Q2_10[ieta]->GetNbinsX(); i++){

			double pn = Nch_gen_all_Q2_10[ieta]->GetBinContent(i+1);
			double pn_err = all_tmp_Q2_10[ieta]->GetBinError(i+1)/all_tmp_Q2_10[ieta]->GetBinContent(i+1);
			pn_err = pn*pn_err;
			
			if( pn == 0. ) continue;
			entropy_all += (-pn)*TMath::Log(pn);
			entropy_all_error += (pn_err*pn_err)*((1.+TMath::Log(pn))*(1.+TMath::Log(pn)) );
		}

		if(ieta > 0){
		gr_hadron_Q2_10->SetPoint(ieta-1,ave_x_0p5_1[ieta],entropy_all);
		gr_hadron_Q2_10->SetPointError(ieta-1,0,entropy_all_error);
		}

	}
	
	
//ln[integral(xG)] starts here

	TGraphErrors* gr_mstw_Q2_2_lnXG = new TGraphErrors();
	TGraphErrors* gr_mstw_Q2_10_lnXG = new TGraphErrors();
	
	for(int ieta = 0; ieta < 7; ieta++){

		double mstw_sum_S_0p5_1 = 0.;
		double mstw_sum_err_S_0p5_1 = 0.;

		for(int i = 0; i < 600; i++){

			double x_value = 1e-5+i*1e-5;

			if( i >= 200 ) x_value = 1e-5+199*1e-5 + (i-199)*1e-4;

			double bin_width = bin_width_before;
			if( x_value >= bin_change ) bin_width = bin_width_after;
			if( x_value >= x1_range_0p5[ieta] && x_value < x2_range_0p5[ieta] ){
				
				mstw_sum_S_0p5_1 += bin_width*xG_Q2_2_mstw[i]/x_value;
				double err = bin_width*(xG_err_Q2_2_mstw[i])/x_value;
				mstw_sum_err_S_0p5_1 += err*err;

			}
		}

		gr_mstw_Q2_2_lnXG->SetPoint(ieta,ave_x_0p5_1[ieta],TMath::Log(mstw_sum_S_0p5_1) );
		gr_mstw_Q2_2_lnXG->SetPointError(ieta,0,sqrt(mstw_sum_err_S_0p5_1)/mstw_sum_S_0p5_1 );

		mstw_sum_S_0p5_1 = 0.;
		mstw_sum_err_S_0p5_1 = 0.;

		for(int i = 0; i < 600; i++){

			double x_value = 1e-5+i*1e-5;

			if( i >= 200 ) x_value = 1e-5+199*1e-5 + (i-199)*1e-4;

			double bin_width = bin_width_before;
			if( x_value >= bin_change ) bin_width = bin_width_after;
			if( x_value >= x1_range_0p5[ieta] && x_value < x2_range_0p5[ieta] ){
				
				mstw_sum_S_0p5_1 += bin_width*xG_Q2_10_mstw[i]/x_value;
				double err = bin_width*(xG_err_Q2_10_mstw[i])/x_value;
				mstw_sum_err_S_0p5_1 += err*err;

			}
		}

		gr_mstw_Q2_10_lnXG->SetPoint(ieta,ave_x_0p5_1[ieta],TMath::Log(mstw_sum_S_0p5_1) );
		gr_mstw_Q2_10_lnXG->SetPointError(ieta,0,sqrt(mstw_sum_err_S_0p5_1)/mstw_sum_S_0p5_1 );
	
	}

	TH1D* base2 = makeHist("base2", "", "x", "S_{EE}", 1000000,0.000005,1,kBlack);
	base2->GetYaxis()->SetRangeUser(0.5, 5);
	base2->GetXaxis()->SetRangeUser(0.000020, 0.05);
	base2->GetXaxis()->SetTitleColor(kBlack);
	
	fixedFontHist1D(base2,1.1,1.25);

	base2->GetYaxis()->SetTitleOffset(1.0);
	base2->GetYaxis()->SetTitleSize(base2->GetYaxis()->GetTitleSize()*1.6);
	base2->GetXaxis()->SetTitleSize(base2->GetXaxis()->GetTitleSize()*1.6);
	base2->GetYaxis()->SetLabelSize(base2->GetYaxis()->GetLabelSize()*1.6);
	base2->GetXaxis()->SetLabelSize(base2->GetXaxis()->GetLabelSize()*1.6);
	base2->GetXaxis()->SetNdivisions(4,6,0);
	base2->GetYaxis()->SetNdivisions(4,6,0);

	gr_mstw_Q2_2_lnXG->SetFillStyle(1001);
	gr_mstw_Q2_2_lnXG->SetFillColorAlpha(kGreen-2,0.4);
	gr_mstw_Q2_2_lnXG->SetMarkerStyle(24);
	gr_mstw_Q2_2_lnXG->SetLineColor(kWhite);

	gr_mstw_Q2_10_lnXG->SetFillStyle(1001);
	gr_mstw_Q2_10_lnXG->SetFillColorAlpha(kGreen-2,0.4);
	gr_mstw_Q2_10_lnXG->SetMarkerStyle(24);
	gr_mstw_Q2_10_lnXG->SetLineColor(kWhite);

	// hist_target->SetMarkerStyle(24);
	// hist_target->SetMarkerColor(kRed);
	// hist_target->SetLineColor(kRed);
	
	// hist_current->SetMarkerStyle(25);
	// hist_current->SetMarkerColor(kBlack);
	// hist_current->SetLineColor(kBlack);

	gr_hadron_Q2_2->SetMarkerStyle(20);
	gr_hadron_Q2_2->SetMarkerColor(kBlue);
	gr_hadron_Q2_2->SetLineColor(kBlue);

	gr_hadron_Q2_10->SetMarkerStyle(20);
	gr_hadron_Q2_10->SetMarkerColor(kBlue);
	gr_hadron_Q2_10->SetLineColor(kBlue);

	TCanvas* c1 = new TCanvas("c1","c1",900,500);
    c1->Divide(2,1,0,0);
    c1->cd(1);
    gPad->SetTicks();
	gPad->SetLeftMargin(0.15);
	gPad->SetBottomMargin(0.15);
	gPad->SetTopMargin(0.06);
	gPad->SetLogx(1);


	TGaxis::SetMaxDigits(3);

	base2->Draw();
	gr_mstw_Q2_2_lnXG->Draw("P e3 same");
	gr_hadron_Q2_2->Draw("PEL same");

	TLatex* r41 = new TLatex(0.65, 0.68, "S_{hadron}");
	r41->SetNDC();
	r41->SetTextSize(22);
	r41->SetTextFont(43);
	r41->SetTextColor(kBlack);
	r41->Draw("same");

	TLatex* r411 = new TLatex(0.65, 0.85, "S_{parton}");
	r411->SetNDC();
	r411->SetTextSize(22);
	r411->SetTextFont(43);
	r411->SetTextColor(kBlack);
	r411->Draw("same");

	TLegend *w5 = new TLegend(0.57,0.57,0.8,0.64);
	w5->SetLineColor(kWhite);
	w5->SetFillColor(0);
	w5->SetTextSize(20);
	w5->SetTextFont(45);
	// w5->AddEntry(hist_target, "target  ", "P");
	// w5->AddEntry(hist_current, "current  ", "P");
	w5->AddEntry(gr_hadron_Q2_2, "#sum #minusP(N)#upointln[P(N)] ","P");
	w5->Draw("same");

	TLegend *w4 = new TLegend(0.57,0.74,0.8,0.82);
	w4->SetLineColor(kWhite);
	w4->SetFillColor(0);
	w4->SetTextSize(21);
	w4->SetTextFont(45);
	w4->AddEntry(gr_mstw_Q2_2_lnXG, "ln(N_{gluon}) ", "PF");
	w4->Draw("same");

	TLatex* r42 = new TLatex(0.18, 0.95, "ep 27.5#times460 GeV");
	r42->SetNDC();
	r42->SetTextSize(23);
	r42->SetTextFont(43);
	r42->SetTextColor(kBlack);

	

	TLatex* r44 = new TLatex(0.63,0.91, "MSTW2008lo90cl");
	r44->SetNDC();
	r44->SetTextSize(21);
	r44->SetTextFont(53);

	TLatex* r45 = new TLatex(0.18, .85, "Q^{2} = 2 GeV^{2}");
	r45->SetNDC();
	r45->SetTextSize(23);
	r45->SetTextFont(43);
	r45->SetTextColor(kBlack);

	r42->Draw("same");
	
	//r44->Draw("same");
	r45->Draw("same");


	c1->cd(2);
	gPad->SetTicks();
	gPad->SetRightMargin(0.1);
	gPad->SetBottomMargin(0.15);
	gPad->SetTopMargin(0.06);
	gPad->SetLogx(1);
	base2->Draw();
	gr_mstw_Q2_10_lnXG->Draw("P e3 same");
	gr_hadron_Q2_10->Draw("PEL same");

	TLatex* r43 = new TLatex(0.63,0.95, "PYTHIA 6");
	r43->SetNDC();
	r43->SetTextSize(0.06);
	r43->Draw("same");

	TLatex* r455 = new TLatex(0.05, .85, "Q^{2} = 10 GeV^{2}");
	r455->SetNDC();
	r455->SetTextSize(23);
	r455->SetTextFont(43);
	r455->SetTextColor(kBlack);
	r455->Draw("same");


	//adding H1 data

	double x_h1[]={0.0013,0.00066,0.00034};
	double y_h1[]={2.09517,2.08562,2.09947};

	TGraphErrors* h1 = new TGraphErrors(3,x_h1,y_h1);
	h1->SetMarkerColor(kRed);
	h1->SetLineColor(kRed);
	h1->SetMarkerStyle(21);
	h1->Draw("PLsame");

	c1->cd(2);
	TLegend *w6 = new TLegend(0.1,0.2,0.5,0.3);
	w6->SetLineColor(kWhite);
	w6->SetFillColor(0);
	w6->SetTextSize(20);
	w6->SetTextFont(45);
	w6->AddEntry(h1, "H1 data #sum #minusP(N)#upointln[P(N)] ","P");
	w6->Draw("same");

	c1->Print("../figures/S_hadron-Q2_10.pdf");

}